#bachend
## Обзор

Эта система состоит из двух основных компонентов:
1. ** Оптимизация маршрута на основе графиков** - Находит оптимальные маршруты через транспортную сеть
2. ** Оптимизация сигналов на перекрестках ** - Рассчитывает оптимальное время подачи сигналов светофора на перекрестках

## Компонент 1: Оптимизация траектории графа

### Ключевые классы

#### Класс `DataSets`
``

наборы данных класса python @dataclass:
    stri: список[str]
    inut: список[str]
    пути: список[кортеж[список[str], список[float]]] | None = Нет
```
- Хранит данные о маршруте для транспортной сети
- Содержит:
  - `stri`: Список идентификаторов улиц
  - `inut`: Список входных узлов
  - `paths`: Список кортежей, содержащих (узлы пути, время в пути)

#### Класс `Edge`
``
класс Edge в python:
    def __init__(self, скорость, длина, приоритет):
        self.speed = скорость # км/ч
        сам.длина = длина # метров
        self.priority = приоритет # весовой коэффициент
        self.time = я сам.продолжительность / (самоскорость * 1000/3600) # секунд
        сам.weight = 1 / self.time, если self.time > 0, иначе 0 # обратный временной вес
```

#### `График` Класс
Основной класс для сетевых операций:
- `add_edge()`: Добавляет новое ребро в график
- `find_best_path()`: находит оптимальный путь, используя DFS с весами ребер.
- `build_sequential_paths()`: Создает приоритетные пути
- `from_csv()`: Создает график из данных CSV
- `visualize_graph()`: Создает визуализацию сети

### Пример использования
``python
g = Graph.from_csv('svias.csv')  # Загружать сетевые данные
data = g.build_sequential_paths() # Вычислять оптимальные пути
g.print_paths(data.paths)  # Отобразить результаты
с помощью g.visualize_graph(data.paths)  # Показать графическое представление
```

## Компонент 2: Оптимизация сигнала пересечения

### Ключевые функции

#### `veber()` - Вычисление задержки
``python
def veber(C, G_phase, q, s):
```
Вычисляет задержку транспортного средства по формуле Вебстера:
- `C`: Общая продолжительность цикла (секунды)
- `G_phase`: время перехода на зеленый режим (секунды)
- `q`: Скорость транспортного потока (ч/час)
- `s`: Скорость насыщения (ч/час)

#### `total_delay()` - Задержка на пересечении
``python
определяет общую задержку(C, G_NS, G_EW, q_bus, s=1800, L=8):
```
Вычисляет общую задержку для направлений Север-Юг и Восток-Запад:
- `G_NS`, `G_EW`: время ожидания для каждого направления
- `q_bus`: Словарь транспортных потоков и разделений автобусов
- "L": Потерянное время за цикл

#### `optimize_intersection()` - Оптимизация синхронизации сигнала
``python
определяет optimize_intersection(C, q_bus, s=1800, L=8, is_intersection_2=False):
```
Находит оптимальное распределение времени, проверяя все допустимые комбинации в рамках ограничений по продолжительности цикла.

### Обработка данных
``python
df_flows = pd.read_csv("flows_peak.csv")  # Данные о потоке трафика
df_signals = pd.read_csv("signals_current.csv")  # Текущее время подачи сигнала
```

### Процесс оптимизации
1. Загружает данные о пересечениях из CSV-файлов
2. Для каждого пересечения:
   - Продолжительность цикла тестирования составляет от 60 до 180 секунд
   - Вычисляет оптимальное распределение времени зеленого сигнала
   - Вычисляет смещения фаз для согласования сигналов
3. Выводит оптимальные параметры для каждого пересечения

### Пример вывода
```
Перекресток 1:
  Оптимальная длина цикла: 90 секунд
  Время зеленого для С-Ю: 45 секунд
  Время зеленого для В-З: 37 секунд
  Задержка для С-Ю: 1250.32 авт-секунд в час
  Задержка для В-З: 980.45 авт-секунд в час
  Сдвиг фазы: 0 секунд
  Общая задержка для перекрестка: 2230.77 авт-секунд в час
```

## Интеграция

Система объединяет:
1. Оптимизация сетевого маршрута для планирования маршрута
2. Синхронизация сигналов на перекрестках для управления транспортными потоками

Вместе они обеспечивают комплексное решение для оптимизации дорожного движения, учитывающее как маршрут движения транспортных средств, так и координацию сигналов.